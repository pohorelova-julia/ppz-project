{% extends 'base.html' %}

{% block title %}Панель адміністратора | {{ block.super }}{% endblock %}

{% block content %}
<h1>Панель адміністратора</h1>

<ul class="nav nav-tabs mb-4" id="adminTabs" role="tablist">
    <li class="nav-item" role="presentation">
        <button class="nav-link active" id="users-tab" data-bs-toggle="tab" data-bs-target="#users" type="button" role="tab">Користувачі</button>
    </li>
    <li class="nav-item" role="presentation">
        <button class="nav-link" id="events-tab" data-bs-toggle="tab" data-bs-target="#events" type="button" role="tab">Події</button>
    </li>
    <li class="nav-item" role="presentation">
        <button class="nav-link" id="comments-tab" data-bs-toggle="tab" data-bs-target="#comments" type="button" role="tab">Коментарі</button>
    </li>
</ul>

<div class="tab-content" id="adminTabsContent">
    <div class="tab-pane fade show active" id="users" role="tabpanel">
        <h2>Користувачі</h2>
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Ім'я користувача</th>
                    <th>Email</th>
                    <th>Дата реєстрації</th>
                    <th>Останній вхід</th>
                    <th>Дії</th>
                </tr>
            </thead>
            <tbody>
                {% for user in users %}
                <tr>
                    <td>{{ user.username }}</td>
                    <td>{{ user.email }}</td>
                    <td>{{ user.date_joined|date:"j F Y" }}</td>
                    <td>{{ user.last_login|date:"j F Y" }}</td>
                    <td>
                        <a href="{% url 'change_user_password' pk=user.pk %}" class="btn btn-sm btn-outline-primary">Змінити пароль</a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <div class="tab-pane fade" id="events" role="tabpanel">
        <h2>Події</h2>
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Назва</th>
                    <th>Організатор</th>
                    <th>Дата</th>
                    <th>Місце</th>
                    <th>Дії</th>
                </tr>
            </thead>
            <tbody>
                {% for event in events %}
                <tr>
                    <td>{{ event.title }}</td>
                    <td>{{ event.organizer.username }}</td>
                    <td>{{ event.date|date:"j F Y" }}</td>
                    <td>{{ event.location }}</td>
                    <td>
                        <a href="{% url 'event_detail' pk=event.pk %}" class="btn btn-sm btn-outline-primary">Переглянути</a>
                        <a href="{% url 'event_edit' pk=event.pk %}" class="btn btn-sm btn-outline-secondary">Редагувати</a>
                        <a href="{% url 'event_delete' pk=event.pk %}" class="btn btn-sm btn-outline-danger">Видалити</a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <div class="tab-pane fade" id="comments" role="tabpanel">
        <h2>Коментарі</h2>
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Подія</th>
                    <th>Автор</th>
                    <th>Зміст</th>
                    <th>Дата</th>
                    <th>Дії</th>
                </tr>
            </thead>
            <tbody>
                {% for comment in comments %}
                <tr>
                    <td><a href="{% url 'event_detail' pk=comment.event.pk %}">{{ comment.event.title }}</a></td>
                    <td>{{ comment.author.username }}</td>
                    <td>{{ comment.content|truncatewords:10 }}</td>
                    <td>{{ comment.created_at|date:"j F Y" }}</td>
                    <td>
                        <form method="post" action="{% url 'comment_delete' pk=comment.pk %}" class="d-inline">
                            {% csrf_token %}
                            <button type="submit" class="btn btn-sm btn-outline-danger">Видалити</button>
                        </form>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}